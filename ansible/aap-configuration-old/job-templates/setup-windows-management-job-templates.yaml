---
- name: Create Windows Ping Test Job Template
  ansible.controller.job_template:
    name: "Windows Management - Ping Test"
    description: "Connectivity test for Windows VMs using win_ping module"
    job_type: "run"
    inventory: "Terraform HCP VMs"
    project: "{{ project_name }}"
    playbook: "ansible/windows-management/windows-ping-test.yaml"
    execution_environment: "{{ execution_environment_name }}"
    organization: "{{ default_organization }}"
    credentials:
      - "windows-admin-credential"
    limit: "os_type_Windows"
    ask_limit_on_launch: true
  tags: [job-templates, windows-management]

- name: Create Windows Patch Management Job Template
  ansible.controller.job_template:
    name: "Windows Management - Patch Management"
    description: "Patch management for Windows VMs using patch-management playbook"
    job_type: "run"
    inventory: "Terraform HCP VMs"
    project: "{{ project_name }}"
    playbook: "ansible/windows-management/patch-management.yaml"
    execution_environment: "{{ execution_environment_name }}"
    organization: "{{ default_organization }}"
    credentials:
      - "windows-admin-credential"
    limit: "os_type_Windows"
    ask_limit_on_launch: true
    survey_enabled: true
    survey_spec:
      name: "Patch Management Survey"
      description: "Control dry run mode for patch management."
      spec:
        - question_name: "Dry Run Mode"
          question_description: "If enabled, no changes will be made. Only a simulation will be performed. Set to 'false' to apply updates."
          required: true
          type: multiplechoice
          variable: patch_dry_run
          choices:
            - "true"
            - "false"
          default: "true"
  tags: [job-templates, windows-management]

- name: Create Windows Software Management Job Template
  ansible.controller.job_template:
    name: "Windows Management - Software Management"
    description: "Install and manage software on Windows VMs including Chrome, IIS, .NET, and Chocolatey packages"
    job_type: "run"
    inventory: "Terraform HCP VMs"
    project: "{{ project_name }}"
    playbook: "ansible/windows-management/software-management.yaml"
    execution_environment: "{{ execution_environment_name }}"
    organization: "{{ default_organization }}"
    credentials:
      - "windows-admin-credential"
    limit: "os_type_Windows"
    ask_limit_on_launch: true
    survey_enabled: true
    survey_spec:
      name: "Software Management Survey"
      description: "Control software installation options and reboot behavior."
      spec:
        - question_name: "Chrome MSI URL"
          question_description: "URL for Google Chrome Enterprise MSI download. Leave default for latest version."
          required: false
          type: text
          variable: chrome_msi_url
          default: "https://dl.google.com/chrome/install/googlechromestandaloneenterprise64.msi"
        - question_name: "Auto Reboot if Required"
          question_description: "Automatically reboot the system if required after software installation."
          required: true
          type: multiplechoice
          variable: ansible_reboot_if_required
          choices:
            - "true"
            - "false"
          default: "false"
        - question_name: "Skip Chrome Installation"
          question_description: "Skip Google Chrome installation."
          required: true
          type: multiplechoice
          variable: skip_chrome
          choices:
            - "true"
            - "false"
          default: "false"
        - question_name: "Skip IIS Installation"
          question_description: "Skip IIS Web Server installation."
          required: true
          type: multiplechoice
          variable: skip_iis
          choices:
            - "true"
            - "false"
          default: "false"
        - question_name: "Skip Chocolatey Packages"
          question_description: "Skip Chocolatey package installation (Notepad++, 7-Zip, Firefox)."
          required: true
          type: multiplechoice
          variable: skip_chocolatey_packages
          choices:
            - "true"
            - "false"
          default: "false"
  tags: [job-templates, windows-management]

- name: Create Windows Administrator Password Reset Job Template
  ansible.controller.job_template:
    name: "Windows Management - Set Administrator Password"
    description: "Reset the Administrator password on Windows VMs using the windows_admin_password variable"
    job_type: "run"
    inventory: "Terraform HCP VMs"
    project: "{{ project_name }}"
    playbook: "ansible/windows-management/system-set-password.yaml"
    execution_environment: "{{ execution_environment_name }}"
    organization: "{{ default_organization }}"
    credentials:
      - "windows-admin-credential"
    limit: "os_type_Windows"
    ask_limit_on_launch: true
    survey_enabled: true
    survey_spec:
      name: "Administrator Password Reset Survey"
      description: "Set the new Administrator password for Windows VMs."
      spec:
        - question_name: "New Administrator Password"
          question_description: "Enter the new password for the Administrator account. Password should be complex and secure."
          required: true
          type: password
          variable: windows_admin_password
          min: 16
          max: 127
  tags: [job-templates, windows-management]
